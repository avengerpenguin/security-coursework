\documentclass{report}

\usepackage[style=authoryear,backend=biber]{biblatex}

\title{The Folly of Passwords}
\author{Ross Fenning}

\bibliography{references}

\begin{document}

\maketitle
\tableofcontents

\chapter{Introduction}

The use of passwords for authentication is certainly commonplace.
% TODO: How many passwords?
It is standard practice within small and large enterprises alike
to require employees to authenticate before using desktop
computers, mobile devices or centralised services (e.g.
as company email, corporate intranet or web-based self-service
systems for tasks such as booking annual leave).

These authentication requirements are largely driven by
several desires:

\begin{itemize}
  \item to prevent use of systems by non-employees;
  \item to maintain an audit trail of employees' usage;
  \item to protect company secrets and intellectual property;
  \item to safeguard the personal information of customers and employees; and
  \item to prevent economic and reputational damage from would-be attackers.
\end{itemize}

Additional security in any system normally comes with additional costs
in terms of usability for users and in financial terms for the organisation
that must implement any security processes and policies. However,
whilst many of the benefits and requirements listed above should justify
these costs, they are notably gains (or prevention of losses) for
the organisation itself more than they are gains for the individual
employees.

In chapter~\ref{chapter:costs}, we will explore the
cost-benefit trade-offs more closely and demonstrate that the status
quo unreaslistically transfers costs to employees to support gains
for the organisations.

Passwords are not the only approach to verifying a user's identity.
The methods by which a user can be authenticated are known to fall
into three categories -- or \emph{factors} -- of authentication
\parencite{council2005authentication}:

\begin{itemize}
  \item something the user \emph{knows}, such as a password, a PIN or
    personal information (e.g. mother's maiden name);
  \item something the user \emph{has}, such as a passport, a mobile device
    a paper ticket; and
  \item something the user \emph{is}, such as their DNA sequence,
    their retinal pattern, their fingerprint.
\end{itemize}

It should be noted that some methods can be argued as spanning
over two factors. For example, a credit card is something
a bank customer possesses, but the card number is something
an attacker could learn without the owner losing ownership
of the card. In the context of many online purchase, credit
card \emph{details} arguably become something a user \emph{knows}.

User authentication that requires two differing factors
of authentication (known as \emph{two-factor authentication}. There
has been a rise in two-factor authenication with companies
such as Google, Amazon, Microsoft, Paypal and Twitter having enabled
two-factor authentication for user accounts.

The mainstream adoption of authentication methods other than
passwords suggests increased ease in enterprises adoption means
of verifying users either instead of or in addition to
existing password setups.

In chapter~\ref{chapter:alternatives}, these alternatives will be
compared and assessed for their ease of adoption within a business.

\chapter{The Cost of Passwords}
\label{chapter:costs}

The username-password pair is arguably a \emph{de facto} standard
authentication mechanism employed by IT and security departments
within many businesses. The default install of any operating
system (Linux, Mac OS X, Windows, etc.) treats all user accounts
as consisting minimally of these pair of credentials and a
username-password login prompt is frequently the first
screen to greet users when a newly-installed OS is booted
for the first time.

In this chapter, we will explore the burden passwords place
on users, the challenges to usability they create and
the effectiveness of standard policies and procedures
frequently employed around password use.

%Linux and Mac systems make use of the Pluggable Authentication
%Mechanism (PAM), which weakens the assumption that authentication
%must be done with a password (password authenication is just one
%module available for PAM). Corporate systems typically make
%use of centralised user directories (e.g. Active Directory, OpenLDAP),
%which allows users to use common credentials across multiple
%IT systems (reducing the need for users to memorise multiple
%sets of credentials).

\section{Passwords and Usability}

\cite{adams1999users} famously asserted 15 years ago that security
departments take an inappropriate approach to security risk
by treating users as risk themselves to be controlled. They
argue further that security compromises are either knowingly
or unknowingly due to the way security is implemented more than
it is the direct fault of users themselves. Their recommendation
is that any security approaches need to be designed in
a user-centric way not just to increase usability, but to
reduce the likelihood of compromises as well.

Their work is still widely cited 15 years later, but
today, employees are increasingly using passwords in their
workplace in addition to a plethora of passwords for
other services used personally outside of work.
A user-centric design
approach to a modern, enterprise security setup needs to
be even more sympathetic to the large burden on users
from managing so many online accounts.

\cite{herley2009so} argues that users rationally reject costs
placed upon them from security policies. He invokes Kuhn's
``Paradigm Shift''\parencite{kuhn1962structure} to suggest
that the increasing burden placed on users with every attack
that takes place and the additional complexity that comes
therewith may hint at an imminent, yet dramatic change in
how users are asked to authenticate. It is yet to be seen
if Kuhn's observations of sudden shifts of thinking
in the scientific community apply to a more general
user base such as employees or indeed the general public, but
a strong need for true change can be taken from the analogy
at least.

%TODO: something about the large list of password rules

Additionally, SOMEONE explored economic arguments and models
to argue that the incredibly low, \emph{a priori} likelihood
of a user's account being compromised leads to a monetary
cost value far lower than that needed to justify a user
spending any real time at all strengthening their password.
This may be a case for a general, public account, but perhaps
some accounts with, e.g. corporate webmail, could be classed
as higher risk and bigger targets for attackers. An attack
on a corporate account might allow access to systems that
can lead to real economic or reputational damage.

We can argue that these costs -- even if higher than those
in SOMEONE's models -- are mainly suffered by the \emph{organisation}
more than the employees. This is very similar to SOMEONE's
arguments that even in the case of banks, they are likely
to take on the costs of fraud and prevent their customers
from exposure to those costs themselves.

This effect is classed
by SOMEONE as a negative externality on computer users in
that they are taking on additional effort to cover costs
that are not their own. These economic arguments can be
used to make a case for organisations taking more
responsibility and investing more to prevent the costs
from a security compromise. This can be combined with
the arguments for a more user-centric design
\parencite{adams1999users} to build a case for a new
authentication paradigm that is low friction to users and
where economic incentives lead to an equilibrium where
organisations spend exactly as much on security as
is rationally justified by their real risks and costs.

\cite{beautement2009compliance} introduce the idea of a
``compliance budget'' which models how users perceive these costs
and benefits. Their work suggests a cap on the effectiveness of any
security measures within an organisation, but also introduces management
approaches to raise the threshold above which a user will no longer
comply with security policies. This arguably increases the cost-benefit
ratio by making it more worthwhile for users to practice secure
behaviour (even if by increasing sanctions such that avoidance thereof becomes
more beneficial than working around costs from complying with security
requirements). They still admit there is a finite limit to improvements to
this compliance budget through management, training and cultural changes.
This supports the idea that many of the costs simply must be moved to the
organisation itself.

So, what is the nature of the burden experienced by users?
In the next few sections, we look at various aspects
of password security, how users are normally advised
and critically examine the effectiveness of that advice.

\section{Password Strength}
\label{sec:strength}

Password-protected accounts are vunerable to at least three
classes of attack\parencite{florencio2014password}:

\begin{itemize}
  \item Malware infection or other direct compromise of the client machine (e.g. keyloggers)
  \item Attacker learns the passwords via phishing, brute-force guessing or other means
  \item Access to a particular system is gained without the actual password (e.g session hijacking, cross-site request forgery)
\end{itemize}

The notion of \emph{password strength} describes how likely
a password is to suffer from an attacker learning the password via brute-force
guessing. A brute-force attack can be said to be \emph{online} (where the
attacker is sending multiple login attempts directly to a system protecting
by authentication) or \emph{offline} (where an attacker has a local copy of
an encrypted file or hashed password, to which she can perform an unlimited
number of attempts at cracking the password without arousing suspicion).

Information Theory and entropy can allow us to gauge a password's strength
in terms of \emph{bits}, which gives us an estimate of the likelihood of
an attacker guessing the password in one attempt. Passwords which are
more unlikely to guess have more bits and are thus consider stronger passwords.

The advice for creating strong passwords normally takes the form of tips
such as:

\begin{itemize}
  \item use longer passwords;
  \item avoid using real words;
  \item use a mix of lower and upper case; and
  \item include numbers and other non-alphanumeric characters.
\end{itemize}

\cite{kaufman2002network} facetiously claimed that humans are poor
at memorising strong passwords/keys:

\begin{quotation}
  \emph{
  Humans are incapable of securely storing high-quality
  cryptographic keys, and they have unacceptable speed and
  accuracy when performing cryptographic operations. (They are
  also large, expensive to maintain, difficult to manage, and they
  pollute the environment. It is astonishing that these devices
  continue to be manufactured and deployed. But they are
  sufficiently pervasive that we must design our protocols around
  their limitations.)
  }
\end{quotation}

This presents a problem if users are poor at working with the
very kind of passwords needed to avoid brute-force cracking. It
would suggest that a user-centric design would lead to something
more in line with abilities humans \emph{do} have.

% TODO: many = who?
Futhermore, many have noted that strong passwords defend
against \emph{only} that single attack vector. Learning the
password within guessing (e.g. via phishing) will put strong
passwords in the hands of attackers just as easily as with
weak passwords. Also, different classes of attacks entirely
such as installing keyloggers via malware or hijacking browser
sessions are unaffected by password strength.

It should also be noted that password strength is
used mainly to prevent
\emph{offline} brute force attacks as many systems
implement a policy of locking an account (or otherwise
delaying password attempts) when too many incorrect
password guesses are made. This effectively negates any
\emph{online} brute force attack against even a very weak
password.

%TODO: who?
Some have thus questioned whether the benefits from strong
passwords are as substantial as standard security advice
would suggest. However, this is perhaps still a concern
for an organisation as it likely does not want to suffer
a breach in an account that had a weak password. Some
online brute force attacks have been known to take place
where the attackers enumerate over all known user accounts
using a set of common or weak passwords. This increases
the probability that they gain access to at least one
account, which may be more useful than targeting a single
account.

So, if there is still an incentive for an organisation
to ensure its employees' accounts are secure, but there
are few pressures (or even rational justification)
for the individual users to spend their time and effort doing
so, what can the organisation do?

One classical solution to weak passwords
has been to enforce password strength \emph{requirements}.
This is a technical solution whereby the systems simply
reject self-selected user passwords that do not conform
to a target strength or entropy.
This is a technical solution that shifts the burden forcibly onto
users and we can argue it is susceptible to the deliberate workarounds
that many users ultimately employ to reduce the overheads
in performing their primary jobs.

Another, softer approach is to attempt to educate users
on choosing strong, yet memorable, passwords. This belief
that weak passwords are always down to lack of training
is fundementally challenged in the influential findings
of \cite{adams1999users}. Their work combined with the
economics-based arguments and models introduced by %WHO?
builds a large weight of evidence that well-informed
users will still not follow much security advice
(sometimes rationally so) to reduce their own costs in
time and effort or to remove a significant barrier
to performing their work tasks.

\section{Password Expiry}

Brute-force password guessing can also be mitigated by
users changing passwords frequently enough that attackers
have a short window within which to guess a particular
password.

As with password strength, this is only mitigating the
brute-force guessing attack vector as phishing, keylogging, etc.
can still give an attacker a password for a short while -- until
the password is next changed. As with password strength, this
is also most effective against offline brute-force attacks (e.g.
the attacker has acquired a list of hashed passwords) an
account locking policy also prevents an online brute-force
attack without the need for passwords to expire.

It is a fairly common practice in many organisations to
implement a password expiration policy whereby the
authentication systems will require a user to change their
password after some defined period of time.

\cite{adams1999users} note that password expiry increases
the burden on users having to memorise multiple passwords and that
50\% of users in their study wrote passwords down, with one
person citing a monthly password expiration policy as the cause
of having to do so.

\cite{zhang2010security} go further to demonstrate the ease of
algorithmically predicting a user's new password when the old,
expired password is known. They assert that password expiration
is weak at achieving the intent behind its implementation and
support the idea of moving away from passwords entirely.

\section{Password Reuse}

Security advice given to users usually includes the suggestion that users
have a unique password for each service they use. This can
be an unreasonable burden on users\parencite{florencio2014password}
and is thus an unrealistic expectation for an organisation or online
service.

\cite{preibusch2010password} showed how the pressure to reuse passwords
presents negative externalities from security-indifferent websites upon
security-concerned websites. This presents an organisation with
security risks stemming solely from the existence of other, less
secure websites with which its employees have accounts.

The secret nature of passwords means an organisation cannot \emph{enforce}
the use of unique passwords, so it must either make reuse impossible or
reduce the impact from reuse. Businesses can make reuse impossible
by having password strength requirements that are stronger than
services less concerned with security, with which employeess may also have
accounts. This is susceptible to the issues in section~\ref{sec:strength}
where this increases costs on users over and above than those they will
suffer from a security breach.

Clearly, password reuse is a coping strategy for users arising from the
difficulty humans have with passwords as an authentication mechanism. This
adds weight further to the case for a real shift away from passwords in
general. We will explore this case in section~\ref{sec:case} and evaluate
the alternatives to password use in chapter~\ref{chapter:alternatives}.

\section{The Case for a Paradigm Shift}
\label{sec:case}

In this chapter, we have built up the following claims:

\begin{enumerate}
  \item Strong passwords reduce guessability, but do not protect against
    many other attacks whilst adding an economically inefficient cost to users'
    time and effort.
  \item Password expiration policies are similar in only protecting against
    brute-force guessing and their effectiveness is called into question when
    users use simple mutations to choose their next password.
  \item Organisations and websites do not exist in isolation, but instead in
    an ecosystem where their users have passwords on other services and are likely
    to reuse them to reduce the burden of memorising too many.
\end{enumerate}

In summary, the use of passwords is problematic for organisations and policies
to reduce those problems place the costs on the wrong people: the users. We can
make the case here for a shift away from passwords in general or at least
for further research into user-centric designs that handle the costs of security
rationally with suitable consideration given to usability.

In chapter~\ref{chapter:alternatives}, we look at some alternatives to passwords
and evaluate them.

\chapter{Comparative Analysis of Password Alternatives}
\label{chapter:alternatives}

\section{What alternatives exist?}

Much of the literature talks about introducting password alternatives
as part of two-factor authentication, i.e. introducting a second factor
alongside a password to reduce some of the insecurities of password use
alone. It could be argued, however, that such methods may be used as
a \emph{replacement} for password use and there would still be an increase
in both usability and security.

Single factor based on possession (``something
you have'') is both more intuitive (people are used to carrying credit cards
and keys safely more than they are capable of memorising random
cryptographic secrets) and more secure (more usability reduces the chance
people will ``work around'' the mechanisms).

Ultimately, if we can evaluate the use of each alternative as if it were
to be used as a single-factor, it should not prevent an organisation
adopting the alternative alongside password authentication in principle. We
gave some consideration for the ease of doing so in our evaluation. We also
would advise always doing so as part of a design that considers the users,
models their use cases and ensures that the approach is indeed increasing
security more than it is just moving the costs onto the users.

\cite{van2011tiqr} introduced a new alternative authentication mechanism
called \emph{tiqr} that uses QR codes and a bespoke smartphone app. In
doing so, he also listed and evaluated a number of existing alternatives. We
can thus make a working list of existing non-password authentication
mechanisms:

\begin{itemize}
  \item OTP Apps (generating One-Time Password codes with a smartphone app, e.g.
    using HOTP or TOTP as are used by Google Authenticator)
  \item OTP Tokens (physical tokens such as SecurID that generate one-time
    password codes at the press of a button)
  \item SMS OTP (sending a user one-time password codes over SMS)
  \item PKI Tokens (a physical item such as a smartcard that contains
    a cryptographic private/public key pair)
  \item Mobile PKI (an approach similar to PKI tokens, but uses the SIM of a
    mobile as the key, which allows key authentication over SMS)
  \item Challenge/response tokens (similar to OTP tokens, but uses symmetric
    encryption to respond to challenges)
  \item TIQR (a web authenication approach that involves QR codes and a
    bespoke smartphone app)
  \item PAM USB (a module for PAM that turns any USB mass storage device
    into a physical key to unlock or lock a computer)
\end{itemize}

PAM USB\parencite{steele2005paranoid} is an additional mechanism added to
this list. It allows users of Unix systems to log in by plugging in a USB
mass storage device.

In this chapter, we will explore the feasibiity of adopting some of
these authentication methods within an enterprise. The primary consideration
is around detailing the setup and maintenance steps and whether any
method can be justifiably ruled out in the early phases of a feasibility
study. In section~\ref{sec:evaluation}, we will look at how the evaluation
was carried out and the remaining sections detail that evaluation against each
considered method.

\section{Evaluating Use in the Enterprise}
\label{sec:evaluation}

Some of the identified alternatives to password authentication were
evaluated for use in an organisational setting. The focus of this evaluation
was to detail the steps involved in creating a toy network of machines
that allowed common authentication across a representative sample of
classes of services that may be used by businesses.

The requirements for our toy/proof-of-concept systems were:

\begin{itemize}
  \item \textbf{Desktop Login}: users can sign into desktop machines using the authentication method
    being evaluated;
  \item \textbf{Company Email}: users can then access their corporate email without needing additionally
    supplying a password to do so;
  \item \textbf{Web Login}: users are able to sign in to a dummy web service (a simple static page
    behind an authentication layer was used);
  \item \textbf{SSH Login}: users should be able to do remote SSH login to development Unix
    servers (this assumes a company where this is a common work task, e.g.
    software development, which is including to exercise the authentication
    further rather than to act as a typical business use case).
\end{itemize}

This setup has many parallels with the needs for common credentials or
Single Sign-On (SSO) within business computer systems. It is typical for
companies to have an authoritative directory server so that users
can at least use the same password across all company services. Some businesses
attempt true SSO and ensure users only type their password during initial
login and they are automatically authorised against all revelant systems
thereafter. This is recommended practice to reduce some of the effort
remembering multiple passwords or even typing the same password several times
a day. Ideally, a suitable password alternative would provide similar
convenience in minimising effort from users when allowing access to a multitude
of systems in a day.

The methods evaluated were:

\begin{itemize}
  \item OTP Apps. This is functionally equivalent to a physical OTP token,
    so a single evaluation was done on OTP apps only with the assumption that
    many aspects will generalise to any OTP generator. Some consideration
    was made around SMS OTP, but this was not evaluated directly.
  \item PKI Tokens. A smartcard-based PKI token was evaluated with the
    assumption again this will extrapolate to any PKI token. Mobile PKI was
    ruled out for consideration as it requires mobile operators to install
    keys on their customers SIM cards, which has been problematic in the
    past.
  \item PAM USB.
  \item YubiKey. This is a hardware USB device from Yubico that can act
    as an OTP generator, a challenge-response token and even a store
    for a static password.
\end{itemize}

TIQR was ruled out as the aims of the project to date seem to be based around
web-based logins only, which does not fit our defined enterprise need of
supporting desktop computer login. Challenge/response tokens are also
out of scope for this paper as they do not differ too greatly from OTP
token and our focus is primarily on evaluating a small, but diverse, set
of password alternatives.

\section{OTP Mobile Apps}
\label{sec:otp}

The chosen OTP system was the OATH Toolkit and specifically its
module for the Unix Pluggable Authentication Module (PAM) system
\parencite{samar1996unified}.

The OATH PAM module was simple to configure on a Debian GNU/Linux desktop
computer and provided one-time password login using any OTP token or mobile
app, such as Google Authenticator. Our setup was tested with both the
command line tool from the OATH Toolkit as well as with the
Google Authenticator Android app.

The challenge here is that each user needs a unique secret which has to
be managed on a trusted server. The secret for every employee then needs
to be available in a configuration file on every desktop computer. This
can be achieved with configuration management systems such as Puppet,
Chef, Ansible, Salt, etc.

Another option is to try to centralise the OTP authentication.
Solutions such as LinOTP suggest the abiity to have a centralised
OTP-based authentication system with a custom PAM module. Combined
with Kerberos, true Single Sign-On should then be possible
including for access to email and web-based applications.

A centralised solution is more flexible for corporate systems
as PAM does not provide an intrinsic method for fowarding local
authentication on to other services. Microsoft Windows achieved
this in the past with NTLM -- which is possible to configure
also on Unix systems with Winbind -- but that is largely
regarded as an insecure mechanism today.

LinOTP also provides centralised web-based identity approaches
such as OpenID and SAML. A company-wide identity provider would
not only allow Single Sign-On within a series of web-based
internal applications, but opens up the possibility of employees
being able to use their company identity elsewhere. One example
is if the company wishes to purchase access to online resources
(online books, journals or any other cloud-based service), they
could make agreement with the provider to allow employees to log in
via OpenID or SAML. Universities already use this model for access to online
journals and academic materials.

Some desktop environments (e.g. Gnome, Mac OS X) provide
a local keychain that can store SSH keys, SSL certificates, etc.
which are unlocked whilst the user is logged in, but inaccessible
otherwise. This already provides a convenience desktop
users, but it relies on the user authenticating with a password
that is then the same password used to update the keychain
(Mac OS X updates the keychain password when the user's main
account password is changed). There maybe be some scope for
further research into whether dekstop keychains can be made
compatible with OTP authentication.

There is certainly scope for further work to evaluate extensive
use of LinOTP and Kerberos within an enterprise setting and the
benefits they bring over relying on a local desktop keychain.

\section{PAM USB}

The PAM USB module for the PAM system is similar in many
ways to the OATH OTP module in terms of setup. The module
installs easily on Debian GNU/Linux systems and it provides
tools to manage a single configuration file that stores a
mapping between users and an identifier for their USB device.

The module also provides a mechanism for locking computers
when the USB key is removed, which is helpful in corporate
environments where users are instructed to lock their desktops
when they are unattended. This mechanism is in line with
drivers removing their keys when they leave their car
unattended, so this is more in line with existing user
habits than asking users not to disclose or to strengthen
their passwords.

However, this PAM module has the same limitations as the
OATH OTP module in that the very simple local authenication
is not easily forwarded to other services on the network.

%An advantage this module has over the OATH OTP module is that
%local applications can make authentication requests
%multiple times without the user needing to be involved. As
%long as the USB device remains connected, applications
%can authenticate multiple times, but OTP authentication
%will require a new password to be entered on each authentication
%request.

An advantage this module has over the OATH OTP module is that
a USB storage device can also store other authentication
information such as SSH keys, SSL client certificates or
anything else to aid the Single Sign-On experience. This
increases the impact of the device being lost unless
these private keys are secured with a password, which
reintroduces passwords back into the user's workflow. Alternatively,
the risks of loss could be mitigated with an effective
key and certificate revocation process.

Futher research may find a solution to storing keys
and certificates on a USB device without passwords or highlight
whether the risks of doing so are too high.

\section{PKI Tokens and Smartcards}

Our test desktop machine was configured to accepted login with a smartcard
reader and an OpenPGP smartcard \parencite{pietig2009functional}. The OpenPGP
card integrates with GnuPG to provide a public-private key pair that can
be used for encryption. For desktop login, we were able to use the ``Poldi''
PAM module.

GnuPG has a gpg-agent service that allows these keys to be used for SSH
authentication as well, which can provide a Single Sign-On experience
between logging in to a local desktop and connecting out to remote servers.

The use of the
smartcard requires a PIN and the card has a lock-out after 3 incorrect tries.
This is behaviour users can recognise from their bank smartcards and the
lock-out feature negates the guessability of even a weak 4 to 6 digit PIN.

The use of a PIN does not eliminate the ``something you
know'' factor, but a short PIN is far less of a burden
than the requirement for users to have strong, random
passwords. This could be a reasonable compromise for an
enterprise given some further usability research.

The difficulty of eliminating a password or PIN from the login workflow
suggests that the PKI token or smartcard approach is more suitable for
situations where security requirements are higher and two-factor authentication
is preferable. The same technology is used for debit/credit card transactions
and for withdrawing cash from a bank account and thus we would expect it
to be used in other organisations that have similar security requirements.

The \emph{Scute} project provides a PKCS~\#11 module that allows an OpenPGP
smartcard to be used with the Network Security Services (NSS) within
the Firefox web browser (we believe Chrome also supports this, but Firefox
was used in our test network). Combined with Apache's \emph{mod\_nss} (which
derives from mod\_ssl), we were able to implement an authentication layer
over a web-based application that supported an OpenPGP smartcard.

NSS also allows the same key to be used within Mozilla Thunderbird for
email authentication. Alternatively, the OpenSC project provides an
OpenSSL engine for PKCS\#11 implementations with which we can store an X.509
client certificate on the smartcard itself.

Given the wide variety of
options for integrating with services such as email, we did not go as far
as to evaluate them all and a thorough examination of a smartcard-based,
enterprise computer network is a subject for further research. The most
subtantial work in this area (that we know of) is from \cite{grossesecuring}.
This research compares different smartcard technologies and software projects
and evaluates them for functionality that overlaps with the enterprise
requirements we are following in this paper. The information seems to be
quite dated now, 8 years later, as we have mentioned projects in this
section that cover functionality claimed not to exist -- especially for OpenPGP
cards.

\section{YubiKey}

The YubiKey \parencite{merkel2009yubikey} is a hardware device
manufactured by Yubico that supports TOTP, HOTP, storing a static password and
a challenge-response mechanism. Yubico provide a substantial amount of
open source tooling and form enterprise partnerships to support a wide
range of applications.

In our test network, we were able to make the YubiKey serve the functionality
of \texttt{pam\_oath} by using as an OTP token. This opens up the possibility
of providing a YubiKey to employees, but also allowing use of mobile apps
such as Google Authenticator if the key is not available (or simply increase
usability by giving users the choice). This might be a crucial option to
allow users to login in to a self-service application with which they can
report their YubiKey as lost/stolen and de-associate it with their user
account.

This also means all the benefits of OTP tokens as outlined in
section~\ref{sec:otp} apply also to the YubiKey. An additional benefit,
however, is that the YubiKey has a button on the device that types the
one-time password for the user, which allows not only for more secure tokens,
but also increases the overhead of the login process. The YubiKey achieves
this by acting as a USB keyboard during this operation.

Further to this, Yubico provide their own PAM module that has a challenge-response
mode that can automatically detect if the user's YubiKey is plugged in
and log the user in without any interaction. This means the YubiKey provides
the functionality of \texttt{pam\_usb} as well.

An Apache module is also available
for both the Yubikey and also generic OTP logins. Whilst having multiple
login points all asking for a new OTP would be an inconvenience when using a mobile
app, this is less of a problem for the YubiKey where the user needs only press
a single button each time. This might allow for internal applications each to
implement their own OTP support and for them to be managed separately, whereas
the OTP mobile app approach would be better with true Single Sign-On.

A drawback is that the YubiKey lacks additional storage for other certificates
or keys (as is the case with a USB storage device or an OpenPGP smartcard). This
makes it difficult to forward the authentication to remote systems. Yubico
produce the more expensive YubiKey Neo which supports OpenPGP and acts as
a smartcard. We did not evaluate this model in our test network.

Perhaps the most promising feature of the YubiKey for business use is the
ability to store a static password as well as the functionality above. A
managed distrubution of YubiKey hardward to employees within an organisation
could involve setting up each key with a strong, static password. The users
would not need to memorise the password, but it could be used as part of
a shared-credentials setup (e.g. LDAP directory service already established
within the organisation) without any significant changes to the technology
used.

In chapter~\ref{chapter:conclusion}, we explore the implication of the
static password feature within a company and draw some conclusions about the
different password alternatives and their use in the enterprise.

\chapter{Conclusions and Recommendations}
\label{chapter:conclusion}

Table~\ref{table:overview} summarises the approaches tried on our test network
and discussed in chapter~\ref{chapter:alternatives}. In some cases, there
are a few alternatives listed where some aspects of more than one approach
were explored. These are by no means a definitive list of all options available
to individuals and organisations and some of the technologies and systems
not evaluated thoroughly are mentioned in passing throughout
chapter~\ref{chapter:alternatives}.

\begin{table}[h]
  \begin{tabular}{|l|l|l|l|l|} \hline
                            & \textbf{OTP Apps} & \textbf{pam\_usb} & \textbf{OpenPGP smartcard} & \textbf{YubiKey} \\ \hline
    \textbf{Desktop Login}  & pam\_oath        & pam\_usb                    & pam\_poldi & pam\_oath, pam\_yubico  \\ \hline
    \textbf{Company Email}  & LinOTP + Kerberos & X.509 certificate on device & Scute      & LinOTP + Kerberos, static password + OpenLDAP   \\ \hline
    \textbf{Web Login}      & OpenID, SAML     & X.509 certificate on device & Scute      & Apache YubiKey/OTP modules, static password + OpenLDAP  \\ \hline
    \textbf{SSH Login}      & Gnome keyring    & SSH key stored on device    & gpg-agent  &  \\ \hline
  \end{tabular}
  \label{table:overview}
\end{table}

Overall, YubiKeys seem to provide the best balance between application support,
usability and compatibility. OpenPGP and other smartcards are perhaps also
a good approach where security is of greater concern and there is some appeal
in terms of usability given users are already used to keeping credit cards
safe and protecting them with short PINs. Their requirement for specialised
card readers and the fact it is still best practice to protect them with memorised
information means significant monetary and effort costs that may be acceptable
to trade off for the additional security, but this must be considered.

LinOTP is a promising enterprise solution that is compatible with Windows
domain setups common in a lot of companies. it appears to provide the most
flexibility in terms of application support.

Perhaps the most important YubiKey feature in practical terms is the ability
to store a static password alongside its OTP behaviour. This enables its
use in \emph{existing} corporate networks where users have a single username-password
pair and all systems authenticate against a directory service such as Active Directory
or OpenLDAP. To set this up, security departments need only include synchronsing
users' passwords to their YubiKeys as part of account creation. Users' passwords
can thus become much stronger and more random without the risk of forgetting or
users resorting to writing them down.

The static password feature is entirely compatible with every system that already
supports password authentication, so the only additional costs are purchasing
the hardware and ensuring users are given quick replacements with new passwords
when they report their existing key lost or stolen. Users are more aware of the
need to report lost or stolen physical items (company ID card, house keys, credit cards, etc.)
whereas the evidence in the literature around passwords suggests users disclose
passwords far more readily (whether deliberately or inadvertantly).

Thus we can recommend coporations are able to evaluate the hardware costs
and consider YubiKeys as a ``drop in'' replacement for users memorising
passwords with few infrastructure changes. This strategy even lends itself
to the possiblity of being run as a trial with one team or department. Over time,
more structural changes such as introducing LinOTP could be considered to
reap some of the benefits OTP and challenge-response bring (e.g. protection
from replay attacks, reduced exposure to brute-force guessing).

It may be possible to run the static password trial alongside introducing OTP
for some applications only. The YubiKey supports generating either token
by using a short versus a long button press, but the usability of that has
not been demonstrated.

\chapter{Further Work}

The following questions are open and are possibilities for further research:

\begin{itemize}
\item What is the effectiveness and what potential issues are there around
  a real deployment of LinOTP within a business? An empirical study in a
  real world setting would give some valuable insights.
\item What is the best approach (if any) to storing keys and certificates on
  a USB device, keeping them secure and allowing them to be used in onward,
  automatic authentication against other services after login? Can a user's
  own USB storage device (already commonplace in many offices) be thus set
  up as an authentication token without the need for specialist hardware
  such as YubiKeys?
\item Today, how easily can an IT or security department set up users with
  smartcards to provide a Single Sign-On experience across all company
  systems? A real world case study would be really useful to bring together
  all the individual projects' documentation and prove an end-to-end deployment
  of them.
\item Are users happy to treat smartcards such as OpenPGP cards within the
  same guidelines already followed for credit cards?
  \item What real world case studies exist for enterprise deployments of YubiKeys?
    Yubico claim multiple corporate customers on their website, but have any
    been studied in the academic literature?
\item Many of the mechanisms discussed are seeing large-scale
  adoption as a second factor in addition to passwords. However, What are the
  security implications of relying on any password alternative as a single factor?
  Do any of them end up being more vulnerable than a traditional, memorised
  password when used in isolation?
\end{itemize}

\printbibliography

\end{document}
